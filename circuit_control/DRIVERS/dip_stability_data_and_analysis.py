
import matplotlib.pyplot as plt

#Data for support coupling to side of disk
params = [[-1.2157836598039888, 7362.004374096126, -2960.1251004602886, 1.6060272467214665, -1.6325249437507278e-06], [-1.222008663462688, 8859.744690471502, -2992.6721370336677, 1.6116911782524894, -1.0976735457434027e-06], [-1.2167165986821793, 8234.36825037535, -2969.1078435811423, 1.606382691910884, -1.4161223920700289e-06], [-1.2143216219276403, 7471.792748294201, -2969.6872853975437, 1.6065592321671875, -1.6305130059229349e-06], [-1.2187708248875195, 8430.007901061821, -2988.5202904595226, 1.6086795134596739, -1.3707468549838025e-06], [-1.2188492122397516, 7592.776368608613, -2980.978519447303, 1.6063962664095046, -1.5944644660992837e-06], [-1.2295576883274213, 9030.417817134536, -3010.328486310685, 1.6108795357255834, -9.988853300072784e-07], [-1.2242829475575896, 8277.566035482017, -2981.8549929114074, 1.6067467711411736, -1.4100895299443258e-06], [-1.2277799733772412, 8589.985532910618, -2991.0757718058803, 1.6074632444966912, -1.2775944503113704e-06], [-1.223088238100378, 7707.117351065002, -2979.3996327731634, 1.6046610733381519, -1.5135693015184254e-06], [-1.2284646551595397, 8945.995815886474, -3016.109546065051, 1.6088685647934944, -1.0792185441267438e-06], [-1.2285805971129253, 9013.764272255126, -3008.1547307137885, 1.6103959825889205, -9.9137885859143e-07], [-1.2354903488654878,
8951.96725264052, -3017.705030187029, 1.6076363735338235, -1.1021083229645184e-06], [-1.2273140499982218, 7672.318843409735, -2994.751277317258, 1.6027455399363415, -1.5700560787238603e-06], [-1.2275293097177926, 7916.0406298669195, -3001.0771907774088, 1.6031189739691913, -1.5166012865020178e-06], [-1.2366553680299326, 9187.241856712008, -3027.6857765654736, 1.6083545589381065, -9.282701044664558e-07], [-1.233628394240759, 8850.42791132302, -3015.0329894760885, 1.6054793144422674, -1.16590214814844e-06], [-1.2300039479802014, 7883.9702282165235, -3009.5259654853794, 1.6019034930250298, -1.5237474317933875e-06], [-1.240075143859556, 9473.750971420122, -3054.87053673643, 1.6092304233816845, -7.372520573754882e-07], [-1.2347696393935375, 8727.828563094161, -3016.9677600407763, 1.6020794635005546, -1.2256960648649027e-06], [-1.232329144796722, 9195.333047533295,
-3040.8888143878094, 1.607269886453695, -9.245934402490935e-07], [-1.2336939315376496, 9069.041582003607, -3030.985470739006, 1.6068296017551011, -1.0301432726868973e-06], [-1.228581594542348, 8011.678673909082, -3016.897467011379, 1.6019345895727162, -1.4795606371375376e-06], [-1.243755682987297, 9568.126268907741, -3066.9607600905892, 1.6093669554647603, -6.644364320533807e-07], [-1.2407505941461525, 9215.241922872096, -3047.4302505801634, 1.6047762978547544, -9.414596767529778e-07], [-1.239085491992286, 8855.87944334881, -3037.9621661301335, 1.6017015479622214, -1.1837609345339123e-06], [-1.239444076752951, 9030.47105208515, -3046.318338475839, 1.6034353368395236, -1.0673744115940513e-06], [-1.234540420223028, 8191.963645254393, -3037.8443465710216, 1.599923830221362, -1.4279552641110903e-06], [-1.2344954564125663, 8355.503478117456, -3038.1172687247713, 1.6006205249852208, -1.389082822595575e-06], [-1.2476063494591612, 9770.230199586236, -3084.1302725576443, 1.6080230613032995, -3.812607657863425e-07], [-1.2500377222987384, 9619.00566086811, -3087.374242010001, 1.606442100081994, -6.302700605680914e-07], [-1.24429457794098, 9382.419090756623, -3071.6119426043015, 1.6038671907850985, -8.196555955341271e-07], [-1.236671113311062, 9089.27614384017, -3049.196367376098, 1.6046273975384393, -1.0123629293984065e-06], [-1.2462001333394384, 9709.8029087281, -3086.5456941024363, 1.6085315687152157, -5.554374279020435e-07], [-1.242136471954871, 9073.482493846433, -3058.0349554103746, 1.6017263040563912, -1.0717523927601322e-06], [-1.247022922947107, 9398.274058241219, -3073.662887653906, 1.6040176479247252, -8.205515889227189e-07], [-1.238294287052792, 8379.995663948452, -3053.6031059779802, 1.5986543557287425, -1.3814911395536709e-06], [-1.2416841454665322, 8475.594723442604, -3062.88003314751, 1.5971816672542765, -1.3524977961677096e-06], [-1.25040964435248, 9658.908542089548, -3108.876026439007, 1.604380501006962, -6.488588682011461e-07], [-1.2375141832352339, 9015.810655205842, -3053.1321059939028, 1.6055752251191637, -1.0621077141755948e-06], [-1.2242090339377714, 8574.309948762013, -3029.8474703211205, 1.6045120839786984, -1.2031155436215374e-06], [-1.2491888206155473, 9725.585745661394, -3104.782047404518, 1.6051670692067013, -6.284701892487722e-07], [-1.2507585013711608, 9714.819136914259, -3094.438206929004, 1.6054667403792342, -5.932157247193107e-07], [-1.2427827368010496, 8552.540538642046, -3062.4142481497497, 1.5939040809210072, -1.2978205905236991e-06], [-1.2522067599674718, 10001.577849792742, -3118.815618720393, 1.606524668471091, -3.791444424685127e-07], [-1.2539133062844638, 9986.19390074019, -3114.8348839250466, 1.6070110270445082, -3.8098072015289414e-07], [-1.2531347474924872, 9785.118199949424, -3107.856224895836, 1.603425671611539, -5.799718259771373e-07], [-1.2455710402407427, 8894.960513855778, -3079.5866749634597, 1.5967148542793588, -1.2232144790891884e-06], [-1.2630885261597318, 10141.712532938667, -3136.5073263165345, 1.6047110355074707, -2.990510066023704e-07], [-1.2478752476983568, 8832.974192416528, -3083.747670607635, 1.594487821819991, -1.2510373068351213e-06]]
times = [17.741771643999996, 17.819012344999997, 17.83408221900001, 17.820994469, 17.841024259000008, 17.834043648000005, 17.824066810999994, 17.83098427599998, 17.839706371000005, 17.82599261500002, 17.865335739000045, 17.83306948200004, 17.834972757999992, 17.831016361000025, 17.838000727999997, 17.838987523000014, 17.843941978000032, 17.81998241499997, 17.83306470399998, 17.824006736, 17.84704606600002, 17.83710131299995, 17.855172533999962, 17.838020865999965, 17.86209682499998, 17.853109173000007, 17.906344228999956, 17.932565468999996, 17.900971980999998, 17.86005326199995, 17.89316227100005, 17.89820342600001, 17.83889775199998, 17.89520207999999, 17.827097170000002, 17.858569826000007, 17.853631755000038, 17.83904247800001, 17.84802876499998, 17.97043130299994, 17.835991638999985, 17.9281353020001, 17.862079075999873, 17.84901214699994, 17.862058254999965, 17.8380188189999, 17.841824003999818, 17.889023261000148, 17.879175788999873, 17.830007039000066]
time_cum = [0]
[time_cum.append(times[i-1]+time_cum[i-1]) for i in range(1,len(times))]
dips = [params[i][0] for i in range(0,len(times))]
offset_min_dips = [params[i][3]+params[i][0] for i in range(0,len(times))]
offset = [params[i][3] for i in range(0,len(times))]
linewidths = [params[i][2] for i in range(0,len(times))]
centers = [params[i][1] for i in range(0,len(times))]

diprange_normed = (max(dips)-min(dips))/max(dips)
print(max(dips)-min(dips))
print(diprange_normed)

#Data for free space coupling to side of disk
params_fs = [[-0.276219736140559, 14790.709269897963, -1036.5577983991107, 0.45354847099389667, 4.949799363372682e-07], [-0.27753424067951993, 16153.618353233924, -1163.6725740024824, 0.45288075086458135, 9.99967465963825e-07], [-0.2711122236031572, 14155.118527349874, -1037.4083892509234, 0.4539804809197588, 3.198815886484639e-07], [-0.27635484306600033, 15797.754573052687, -1087.6397530530373, 0.45314146243277825, 8.05590433682362e-07], [-0.27142479014465554, 14283.05020137845, -1037.9823680636437, 0.4541398260466719, 3.4269990782303566e-07], [-0.2768786616535521, 16055.043408846946, -1135.055922587746, 0.45324147733089776, 9.395831964082489e-07], [-0.2733418814554955, 14275.162907417325, -1043.447133827153, 0.45391777204888145, 3.532762488197219e-07], [-0.28312302578141396, 16120.940800522918, -1171.082403490746, 0.45225590572136604, 1.0286259299679839e-06], [-0.28118265770901507, 13976.207146371326, -1055.9698039128568, 0.45265777331602286, 3.3789047196467373e-07], [-0.2887711589005926, 15974.395447275685, -1152.107438684038, 0.45113022570996253, 9.960178952339845e-07], [-0.28074309960236904, 14231.776891726704, -1055.9899224204132, 0.4542580444932917, 3.720365248028522e-07], [-0.2867312404856539, 15977.954788304054, -1144.844186940439, 0.4527846770095944, 9.817237341528653e-07], [-0.2866648919831905, 15828.030101761276, -1119.0240903056797, 0.4525314029198214, 9.030778612689793e-07], [-0.28110329509350007, 14231.532279588788, -1056.847415853451, 0.45338447166558443, 3.8300996580365143e-07], [-0.28517834905031614, 16025.780937063513, -1150.9538282234612, 0.4522006597417822, 1.0050237801177168e-06], [-0.27983135057475794, 14220.51855179125, -1053.9409447648054, 0.4531898183305052, 3.779452014668189e-07], [-0.28538396655887316, 16059.488944050763, -1158.7710209777229, 0.45186963739312414, 1.0259925975787898e-06], [-0.28520044536770445, 15922.996554946434, -1132.3886086775335, 0.4518802151912015, 9.467080308504624e-07], [-0.27937533900828, 13784.051164059549, -1048.1951308111597, 0.4525390246800054, 3.1006864545151036e-07], [-0.2858056344572316, 16047.470798761744, -1158.3865962257264, 0.4513179322360268, 1.024692561768186e-06], [-0.2803971393556954, 13850.887083575411, -1051.066754292712, 0.4522826905467184, 3.283116492002304e-07], [-0.2863757770816172, 16131.86256377816, -1180.3494818986949, 0.4509487897933387, 1.082848855338949e-06], [-0.2813648997991327, 14216.45620526076, -1058.8312231159139, 0.4520308998269187, 3.9399459765764945e-07], [-0.28620063689842457, 16029.467564560533, -1153.7365716002441, 0.4507692392578311, 1.0253790834246312e-06], [-0.28152207781258154, 14080.76168036962, -1059.991962634617, 0.4516938656666765, 3.7112070732974164e-07], [-0.28929323466123386, 15969.479102424457, -1151.477514996208, 0.4493757568125037, 1.01432458265245e-06], [-0.28411858508985843, 14201.476901524207, -1066.1074461112007, 0.4507805050731071, 4.1162620662180486e-07], [-0.28955963716799044, 16059.98910192173, -1172.143533894794, 0.44951933975593744, 1.071494402918771e-06], [-0.2839876337734946, 14339.316637042917, -1067.1848275805305, 0.45049815394026915, 4.405500498709253e-07], [-0.2896542141697518, 16066.45858888852, -1174.5817318755837, 0.4490429079592458, 1.1062929705880152e-06], [-0.28504150831117986, 14295.32431901184,
-1068.9096903037266, 0.4501575730934413, 4.3461794998502555e-07], [-0.29161993418259585, 16049.481646831939, -1175.3824341589082, 0.448795853421552, 1.087763773817866e-06], [-0.2860573731752295, 13864.64172261577, -1063.3374445504396, 0.4497592318308028, 3.662114709707304e-07], [-0.2920915987955527, 16047.547987786711, -1175.8403704461964, 0.4486383523885372, 1.088793042252668e-06], [-0.2868229947220261, 14236.203225852536, -1073.0526263007173, 0.44961509092289503, 4.366947055138304e-07], [-0.29116220512423735, 16053.899760794346, -1176.1461084372893, 0.4482361532462386, 1.0881655402475057e-06], [-0.2868890915046443, 14336.317970108297, -1072.7969080641963, 0.44915415423675764, 4.5551353510945195e-07], [-0.2921571285969819, 16030.087923614707, -1172.8449955488838, 0.4476695857080457, 1.08522476258237e-06], [-0.28694063890822996, 14116.804298438165, -1070.2222905767092, 0.44870025182279666, 4.10811278388347e-07], [-0.29147785429185635, 16092.407573451854, -1182.6094215890112, 0.4474880047887119, 1.1156919795102084e-06], [-0.28898349628259806, 15655.27863326599, -1103.103191693018, 0.44760324284096975, 8.612969539633617e-07], [-0.28864727505040905, 15375.555836122441, -1082.5286827097111, 0.4483601002810565, 7.465811862741492e-07], [-0.2904389510888172, 15936.679450736769, -1143.674822748298, 0.44764331785910727, 1.0229083056860786e-06], [-0.28583164957045526, 14246.041138352468, -1071.2120098286885, 0.44801257244877624, 4.7132786810801615e-07], [-0.2914909315158685, 16117.8324560448, -1185.636115422828, 0.4472401710575247, 1.1368911864306952e-06], [-0.2882519861702284, 14452.190122476473, -1067.424612359949, 0.4484983489856531, 5.106637317306905e-07], [-0.2916235385377996, 15935.213751412051, -1147.3285425182153, 0.44661238539073334, 1.0304836375668378e-06], [-0.2890557679128311, 14618.20191396539, -1065.981588075698, 0.44828320682709066, 5.420483319588857e-07], [-0.2870344443787197, 14273.382171031993, -1068.5516233926123, 0.4482937201136437, 4.462341409065678e-07], [-0.2916669677911243, 16059.197771508909, -1171.5223301323435, 0.4470814964074556, 1.096835034574492e-06]]

dips_fs = [params_fs[i][0] for i in range(0,len(times))]
offset_min_dips_fs = [params_fs[i][3]+params_fs[i][0] for i in range(0,len(times))]
offset_fs = [params_fs[i][3] for i in range(0,len(times))]
linewidths_fs = [params_fs[i][2] for i in range(0,len(times))]
centers_fs = [params_fs[i][1] for i in range(0,len(times))]

diprange_normed_fs = (max(dips_fs)-min(dips_fs))/max(dips_fs)
print(max(dips_fs)-min(dips_fs))
print(diprange_normed_fs)




plt.show()
#Data for support coupling to side of disk

params_supports_2 = [[-0.41870147845501166, 143.13521602721113, -363.78012092200083, 1.2417449533602058, -1.9361214364761166e-06], [-0.4185891472605903, 207.63427019509402, -364.2755462946644, 1.2420331458901337, -1.878381914759425e-06],
[-0.41849533695737434, 214.98616817199107, -364.5359115924171, 1.2421816929166711, -1.8437259621302315e-06], [-0.41841389769689746, 210.57960904800774, -365.59317039330153, 1.2428892253622605, -1.8011588673853663e-06], [-0.41852686903539693, 211.4917987050957, -365.25285750631207, 1.2424097879880047, -1.8374109674099634e-06], [-0.41858789405648655, 216.5070762123688, -364.8078913786602, 1.2425479890280164, -1.8085989820838095e-06],
[-0.4183032275911388, 209.62364311948886, -364.88285885994634, 1.2425459210415972, -1.8273447565811878e-06], [-0.41835752975505497, 197.02704345538322, -364.92960132194304, 1.2420391178917904, -1.8086736641278655e-06], [-0.41870531069280575, 188.5707647450754, -365.16878969611764, 1.2421980449520882, -1.797213141530268e-06], [-0.4187147801539418, 171.07021840072753, -365.66072447448306, 1.2424021456014283, -1.73089187591752e-06], [-0.4187080970984498, 158.09133326146681, -365.06402848380696, 1.2420749887548224, -1.7723868003099206e-06], [-0.41866192116880097, 154.700215783932, -365.9471684083618, 1.2422707372116872, -1.7755559453202678e-06], [-0.41855718408585635, 147.48443882866687, -366.03327462488556, 1.2423346470326755, -1.7950476659188526e-06], [-0.4183717201857352, 135.55609742337236, -365.9404967933516, 1.242348201293215, -1.7840848400532397e-06], [-0.4187488760298521, 114.68865735666526, -366.0760636737284, 1.2422740047563126, -1.7768205766745802e-06], [-0.41854526698181954, 106.29408769678061, -366.2837046599568, 1.2423269863954463, -1.77265437192686e-06], [-0.41871436267676454, 99.93163552646735, -366.2150659544655, 1.2423704618378764, -1.7707078075603291e-06], [-0.41873519252209945, 82.2664770142457, -366.05944816495673, 1.2423855913818995, -1.7929060649968047e-06], [-0.41859554747074795, 78.25094567960286, -366.5059579594046, 1.242457837188519, -1.7894803866016775e-06], [-0.41858148354407737, 73.00705456412555, -366.18905782159254, 1.2424740337008784, -1.7629186962488997e-06], [-0.41876892156784296, 65.32926933448583, -366.5230245542498, 1.242463907740811, -1.76797925855454e-06], [-0.41854375364510216, 56.34639215702147, -367.0688896382181, 1.2425455848794171, -1.7770445541392625e-06], [-0.41853068124068027, 50.150201303429576, -366.4514744543368, 1.2424000202443652, -1.7598054097142964e-06], [-0.4187392734651537, 40.84018405561231, -366.97783759481314, 1.2425331568749967, -1.765423652842635e-06], [-0.4184674182417075, 30.38148839636933, -367.3952119649918, 1.2427712264103592, -1.7701946241184063e-06], [-0.41891625290483797, 22.81109026346684, -367.2452466445065, 1.2428652748246256, -1.7619775196860943e-06], [-0.41852679848988683, 14.478443251824801, -366.9773773989666, 1.242831910103101, -1.7560189664308395e-06], [-0.4183380566235882, 5.601944707421598, -367.575675797, 1.2429737794520952, -1.7420099931006501e-06], [-0.418740051473247, -4.057182972369251, -367.23793758968054, 1.2430377171299845, -1.754508245662937e-06], [-0.4188132819369678, -13.902795832418704, -367.7951111061143, 1.2432726117158857, -1.7720816357315143e-06], [-0.4188338740909028, -21.25960175836355, -367.70895641760245, 1.243277611826056, -1.7463588289180449e-06], [-0.41859624496635356, -32.3697890098103, -368.02168404364994, 1.243342826750147, -1.7520562605657878e-06], [-0.41882607915153097, -39.866895743452616, -367.679545713516, 1.2434776704105461, -1.7626356403644615e-06], [-0.41888677279968944, -49.749491087379084, -368.1987380784938, 1.243632660221983, -1.7555896007662736e-06], [-0.4188059107561876, -60.25060939943014, -368.12640154929596, 1.2437458598044784, -1.740729389282773e-06], [-0.4189765011915747, -69.26874965792902, -368.4963254881456, 1.2438480575731772, -1.7304800606188597e-06], [-0.41899014724264144, -79.20832875480713, -367.85509263747633, 1.2438455514237612, -1.7275901324911306e-06], [-0.41900115231393564, -90.90481470888349, -368.37166206988525, 1.2439969159737696, -1.7385731487007554e-06], [-0.4188277836469639, -103.46911403477164, -368.6735600792699, 1.2440894196022902, -1.7392709911480376e-06], [-0.4188855209964515, -111.82542543536549, -368.7777950494735, 1.244138486329377, -1.7425539773188449e-06], [-0.41894854845969964, -122.78716598907663, -369.01286547039854, 1.2442277523539544, -1.7501339424586746e-06], [-0.4190407926279177, -134.12476610781837, -368.8266637363298, 1.2443503450145514, -1.7408430237859528e-06], [-0.4189920820303681, -149.27994476623437, -368.80523506709955, 1.2443340282739512, -1.7342459259509547e-06], [-0.41889007121875965, -160.9166428869173, -368.94491260126495, 1.2440449472257302, -1.737045702978532e-06], [-0.4188223451587051, -187.45233522055605, -369.0897690191302, 1.2442525830159863, -1.7341848079726584e-06], [-0.41891574485136285, -200.248763628727, -369.2254591267859, 1.2443092184287492, -1.7459003001106137e-06], [-0.4191035758483775, -215.00301316495717, -369.30509310155463, 1.2444968937592962, -1.7302494861471278e-06], [-0.4192815731457627, -226.12731194748494, -369.7374922309096, 1.244486940380278, -1.7438854555845504e-06], [-0.41921933739158385, -235.17076410846244, -369.4097753339786, 1.2445248303337646, -1.7372455582970902e-06], [-0.4192843265152815, -245.87219798033874, -369.87770189680344, 1.2447243082913704, -1.7457031747152053e-06], [-0.4194010671825356, -266.36864930054145, -370.21075084409387, 1.2446947214862052, -1.7485057631338476e-06], [-0.4191731451998974, -277.4350433743651, -369.809516942509, 1.244473954521955, -1.7464662515484377e-06], [-0.4194312896320541, -287.8235020055353, -370.0735767840202, 1.244731045085648, -1.7307955395593814e-06], [-0.419470435944902, -293.2475903601098, -370.1282993688001, 1.2447084083184605, -1.7308400026595042e-06], [-0.4192172783962198, -304.9666304495276, -370.64018687809113, 1.244501405461355, -1.7268061348264563e-06], [-0.4192460579410642, -313.88838022713117, -370.4207913820179, 1.244371864146548, -1.726251473150246e-06], [-0.4195862834849631, -333.13794205291344, -370.50191579901383, 1.2441969401000792, -1.7323032600440126e-06], [-0.4192149635183273, -339.8796915670435, -370.73397479579313, 1.2442882694228563, -1.7276684220457379e-06], [-0.4196072458966145, -345.87084658885874, -370.3669342723321, 1.2446568905444169, -1.7103179261443776e-06], [-0.41942553314245584, -356.3895341870449, -370.65392361114135, 1.24460704561342, -1.7094480445823806e-06], [-0.4195033509086645, -367.2464390424754, -371.03414184083607, 1.2444558382698991, -1.7221801343362684e-06], [-0.41980795678271815, -378.94209816247746, -370.76759991447744, 1.2442990711059934, -1.7203618309061843e-06], [-0.4196842528981148, -400.0778308471836, -371.0842365942161, 1.2440424558950873, -1.7180092418330735e-06], [-0.4194178645492208, -400.7479752222884, -370.6682201130988, 1.243758897635636, -1.723005299548425e-06], [-0.4197370235368815, -419.34314694378406, -371.4060916776305, 1.2438438071062465, -1.7170083585109282e-06], [-0.41974084998690553, -429.1197339466502, -371.5739822314141, 1.2438806087606613, -1.715104925782377e-06], [-0.420003623392443, -438.34569633453526,
-371.4665339792795, 1.2440441055902425, -1.6997694189769456e-06], [-0.4199546511063585, -450.6143904499885, -371.42090435434085, 1.2442841561311198, -1.7116637294613855e-06], [-0.4200468934780578, -458.09889468997903,
-371.2758308669814, 1.2442172517994723, -1.725831377821851e-06], [-0.4199891101913867, -464.9247532648259, -371.71817070420144, 1.2443918282495712, -1.7109948446059112e-06], [-0.4202081116965796, -472.21566616378897, -371.33284239192204, 1.2443964219981458, -1.709260152847076e-06], [-0.42040254201774296, -486.625338138877, -371.3358991852524, 1.2445481193986627, -1.728249262685291e-06], [-0.42053216803296756, -493.7313631926973, -371.41886104768577, 1.2445223247215809, -1.7266048694593376e-06], [-0.41986748389208206, -499.51251069989615, -371.7351928859657, 1.2436678599431836, -1.7184311928649928e-06], [-0.4203109193186895, -513.111248777672, -371.76590413541356, 1.2439925211402592, -1.7102233667793828e-06], [-0.4205096211434073, -529.2652889925029, -371.826727126707, 1.2443658948071554, -1.7044886292432015e-06], [-0.4207775737125466, -538.983560408735, -371.68555448693354, 1.244467483133756, -1.7323611388562002e-06], [-0.4207489704871239, -548.9494871377372, -372.1161622992968, 1.2449250049383205, -1.7315582334848741e-06], [-0.4212302425560276, -565.4248449143842, -371.9272158395039, 1.2448021467440828, -1.7156604515908768e-06], [-0.42089949935742466, -572.0756548294312, -372.12901293367906, 1.2448748041124837, -1.706896771695567e-06]]

times_support_2 = [0, 17.007380312999885, 34.01725406699984, 51.017075549999845, 68.01886277199992, 85.03376948899995, 102.03449140900011, 119.04920834400014, 136.06392289000019, 153.08057211400023, 170.0933137530003, 187.09501461800028, 204.10466241000063, 221.10833447600044, 238.11905780900065, 255.11869463000062, 272.12431741700084, 289.18649336300086, 306.1948290690011, 323.19741705900105, 340.199004601001, 357.20942278200073, 374.22711512200067, 391.23772718000055, 408.2553850450008, 425.2528772680007, 442.2534114540008, 459.2700145990011, 476.2664759940012, 493.2659445380009, 510.2883896060007, 527.2968727670004, 544.2974465490006, 561.2965877540005, 578.2929952190002, 595.2954982180004, 612.3089798670007, 629.3094369130008, 646.3249020510007, 663.3380870820006, 680.3555896410007, 697.3699788960007, 714.3813446200006, 731.4422255470008, 748.4647610680008, 765.4782478370012, 782.5178397940012, 799.5581611800017, 816.5664432960016, 833.5969158450016, 850.6242877200016, 867.6325507220017, 884.6475308250015, 901.6898565210017, 918.7510736620015, 935.7936410220013, 952.8399005870015, 969.9360054260014, 986.987612322001, 1004.007915863001, 1021.0209657260011, 1038.0560718780011, 1055.0591906420009, 1072.078301905001, 1089.0885105080006, 1106.1096373450005, 1123.1252946540003, 1140.2275926480002, 1157.2568029460003, 1174.3167114140006, 1191.3607017930012, 1208.3857225630018, 1225.3953850320017, 1242.4153315380022, 1259.4701879290028, 1276.4802084570033, 1293.500277502003, 1310.5099734210025, 1327.5278883100023, 1344.538542012002, 1361.5533852410022]
times_support_2.pop()

dips_2 = [params_supports_2[i][0] for i in range(0,len(times_support_2))]
offset_min_dips_2 = [params_supports_2[i][3]+params_supports_2[i][0] for i in range(0,len(times_support_2))]
offset_2 = [params_supports_2[i][3] for i in range(0,len(times_support_2))]
linewidths_2 = [params_supports_2[i][2] for i in range(0,len(times_support_2))]
centers_2 = [params_supports_2[i][1] for i in range(0,len(times_support_2))]
diprange_normed_2 = (max(dips_2)-min(dips_2))/max(dips_2)


#side_coupling_data again

params_supports_3 = [[-0.12600111629135732, -4410.094466518263, 234.80711828204323, 1.1985363628318695, -1.1839837705620883e-07], [-0.12602589941864153, -4409.574384989323, 234.7224137140571, 1.198538369455134, -1.1905465910864044e-07], [-0.12600484486578198, -4408.187702234972, 234.4499373136533, 1.1985348986571887, -1.1823901087531795e-07], [-0.12601379339673666, -4407.913522314172, 234.49435188380704, 1.1985358084598374, -1.1842954011708044e-07], [-0.12601628670348022, -4407.965858277029, 234.3646444173211, 1.198535105657746, -1.1833225097710387e-07], [-0.1260159043245163, -4405.5014961113075, 234.3716212936338, 1.1985362244037383, -1.1860577031988023e-07], [-0.12603016684289892, -4406.6603002379625, 234.4935755357679, 1.1985377149011336, -1.1893838025843906e-07], [-0.1260316518676588, -4406.069641070638, 234.57146952608136, 1.1985388318721601, -1.1914461946869943e-07], [-0.12602874974986156, -4405.597097849771, 234.50631509953453, 1.1985377801602575, -1.189163610761256e-07], [-0.1260237665472308, -4406.489827989844, 234.65223418226537, 1.1985384942024346, -1.1894262471732102e-07], [-0.12598418991813204, -4405.3508486514065, 234.3653332777667, 1.1985340169709453, -1.1796895201904842e-07], [-0.12598302686931534, -4405.864255789471, 234.40433960937833, 1.1985345961125773, -1.1813337563700353e-07], [-0.12598146011988412, -4405.181899952095, 234.26102378977163, 1.198534230388033, -1.1816429908020797e-07], [-0.12600474175485527, -4404.741281502885, 234.2387762078917, 1.1985352471512851, -1.1839045355209169e-07], [-0.12602106851023154, -4406.46393937752, 234.301562553879, 1.1985353836590666, -1.1846033060847159e-07], [-0.1260380163693132, -4405.796790889045, 234.6224144684399, 1.198539137060936, -1.191838350853236e-07], [-0.12599436468938005, -4404.948218546577, 234.35033521982226, 1.1985356245431842, -1.1836703898732587e-07], [-0.12599000855704187, -4404.623406444855, 234.32336991073623, 1.198534188493235, -1.1797174847107615e-07], [-0.12597706767430736, -4405.220196226078, 234.23746112749922, 1.1985324763853689, -1.1760502520209665e-07], [-0.12600296086110008, -4405.859808433071, 234.2808710958977, 1.198534376676239, -1.181360393907716e-07], [-0.12602117624510503, -4404.6745158682525, 234.4505413939673, 1.1985386709539518, -1.1918171022320903e-07], [-0.12602313345040783, -4404.604838494023, 234.60135274647732, 1.1985389604139907, -1.1906450135167891e-07], [-0.12599467029916522, -4404.23754445488, 234.3028199910506, 1.1985347896798046, -1.1817625367753475e-07], [-0.12602176938533832, -4405.381253268571, 234.29120116048804, 1.1985352890427037, -1.1834365042489356e-07], [-0.126045183646489, -4405.904959870762, 234.57714462028434, 1.198539312331305, -1.192347958795563e-07], [-0.12601371637691225, -4404.144292471822, 234.29732827710825, 1.1985352150127513, -1.1825417902729031e-07], [-0.1259939193600025, -4404.981397389205, 234.31527892345372, 1.1985351361192202, -1.1824692119991053e-07], [-0.12599581801551765, -4405.563941766411, 234.16341696194118, 1.1985334390840792, -1.1801523719658301e-07], [-0.12602287783882563, -4403.705296867004, 234.32878241393843, 1.198537169221683, -1.1883238539792758e-07], [-0.1259951255256629, -4404.581944965433, 234.34688164324928, 1.198535759737417, -1.183915549541517e-07], [-0.12598761209478818, -4403.948890438619, 234.19085515009587, 1.1985340385031509, -1.180470327696572e-07], [-0.126022747524536, -4404.407556938644, 234.3494511028544, 1.1985376897447773, -1.1895044718173023e-07], [-0.12604007037951254, -4403.414387221529, 234.40166090361512, 1.1985378886646623, -1.1894101435751056e-07], [-0.12599662209240947, -4403.763086967025, 234.25122669612176, 1.19853495508896, -1.1823432473649496e-07], [-0.12600535316716005, -4404.016918942507, 234.22614459487437, 1.1985349284512412, -1.1824149594491003e-07], [-0.12599663337061653, -4404.483836659477, 234.16854708679162, 1.198534102646347, -1.1818704540509958e-07], [-0.12602067651302, -4403.696161322676, 234.3755756269503, 1.1985375052049994, -1.1879263377158845e-07], [-0.12602088109024684, -4404.123928786133, 234.25383448158493, 1.1985356513116774, -1.1836623794868367e-07], [-0.1259886008874783, -4404.571191550006, 234.15019559204185, 1.198533079832396, -1.1784467477403201e-07], [-0.12604717709064908, -4404.823507171585, 234.3415059673437, 1.1985375769682538, -1.189144578178042e-07], [-0.12601177901691676, -4403.537528720596, 234.43712384883344, 1.1985374139064942, -1.1872721873197585e-07], [-0.12598107879379722, -4402.498216804849, 234.10080289253608, 1.1985333901226904, -1.1787766386733375e-07], [-0.12599606807017344, -4403.688991225573, 234.2110725492981, 1.1985351970010856, -1.1836275346556497e-07], [-0.12601808533230724, -4404.4177974209715, 234.37167870052986, 1.1985372196886388, -1.1881059407986131e-07], [-0.12603410861378278, -4402.770603086756, 234.25193700192168, 1.198537703964221, -1.1899400700083696e-07], [-0.12599559035250865, -4403.602382140881, 234.26199814358705, 1.1985352713934498, -1.1831120229688507e-07], [-0.1259995377825361, -4403.229268378622, 234.23154832660458, 1.1985351839079472, -1.1826021238975708e-07], [-0.1259927146748267, -4404.59572232626, 234.11216759173587, 1.1985335357520595, -1.1798435634981459e-07], [-0.12604195233413673, -4403.052867947506, 234.39985386014604, 1.1985385152348997, -1.19092688222574e-07], [-0.12602251018377528, -4403.222093971246, 234.2558624297446, 1.1985364297286971, -1.1862504002980445e-07], [-0.1260178023631824, -4403.074557583157, 234.30420953141427, 1.198536472655002, -1.1854085167075552e-07], [-0.1259988115689155, -4403.411168934133, 234.23583633814147, 1.1985351262793285, -1.182614721543826e-07], [-0.12598694111158878, -4403.712768429769, 234.1470178731558, 1.198533185327414, -1.178762365457993e-07], [-0.1260282490059319, -4401.779853977647, 234.25027652560175, 1.1985382812353127, -1.191356814604323e-07], [-0.12601690364972365, -4400.833690661318, 234.43158782677742,
1.1985391191297807, -1.1922195041930398e-07], [-0.12601757704188654, -4403.6505951255585, 234.46162847531778, 1.198537908494143, -1.1883555354238037e-07], [-0.12598095242735916, -4402.790006208404, 234.26545269864442,
1.1985342772583931, -1.1800995418460841e-07], [-0.1259881910981829, -4403.899482008446, 234.13159286041318, 1.1985329767027313, -1.1779200772943957e-07], [-0.12602407460549828, -4403.334127078922, 234.2119473552067, 1.1985359615075368, -1.1855872673600697e-07], [-0.1260145820675578, -4401.723416577781, 234.12287489961557, 1.1985359670645641, -1.1852184063971021e-07], [-0.12597793676901628, -4402.867178074751, 234.10763122011468, 1.198532660723727, -1.176123964706763e-07], [-0.12599562074823809, -4403.463762641305, 234.16145360570164, 1.198534285066737, -1.1813900656503022e-07], [-0.12602510467634734, -4402.665530611058, 234.2735669893829, 1.198537812260564, -1.190029832929726e-07], [-0.12602792702454166, -4403.8342843053715, 234.2917986689125, 1.1985369783078752, -1.1879982326524635e-07], [-0.12599871287187592, -4402.5107323459815, 234.24205212828, 1.1985355305196561, -1.1835438562555807e-07], [-0.1259871846362549, -4402.14494752045, 234.1849150065198, 1.1985337925808923, -1.1790970691616733e-07], [-0.12599616286077472, -4402.852202971942, 234.26716206669624, 1.198535362045933, -1.1830575928044493e-07], [-0.12599901749794146, -4402.790866703158, 234.0812120312672, 1.1985344250573449, -1.1820640846243167e-07], [-0.12602214875183826, -4402.837231692559, 234.07847436329405, 1.198535409962041, -1.1849531764960527e-07], [-0.12599568881492645, -4401.890487431174, 234.23267139330207, 1.1985363094016366, -1.1869219764399521e-07], [-0.12602134124499095, -4401.99876109242, 234.3084606806966, 1.1985380820186495, -1.1900697511749333e-07], [-0.1260186417652435, -4403.171101981367, 234.41149962186066, 1.198538584000052, -1.1906627871336512e-07], [-0.12599815074408488, -4403.094175755665, 234.37388071974718, 1.1985367238745994, -1.1858513625361996e-07], [-0.12600321701961095, -4402.112536971109, 234.18006323745993, 1.1985347589092374, -1.181663705416177e-07], [-0.12600312999707103, -4402.860583035046, 234.2168737390252, 1.1985357058704174, -1.1842638671712895e-07], [-0.1260012973236128, -4401.605049512213, 234.22615694781277, 1.1985356775673526, -1.1836450750732508e-07], [-0.12598425520129022, -4402.69326019693, 234.20331047592833, 1.1985336992376885, -1.178933640006679e-07], [-0.12598311148409022, -4401.412415172691, 233.99555207283342, 1.1985334465225057, -1.1798393896575614e-07], [-0.12597597112009207, -4403.6123586524045, 234.04699811536946, 1.1985331416900677, -1.1791853140799402e-07], [-0.12599805740004685, -4403.056208338403, 233.97379103026265, 1.1985324818425755, -1.177645743067006e-07]]

times_support_3 = [0, 17.007380312999885, 34.01725406699984, 51.017075549999845, 68.01886277199992, 85.03376948899995, 102.03449140900011, 119.04920834400014, 136.06392289000019, 153.08057211400023, 170.0933137530003, 187.09501461800028, 204.10466241000063, 221.10833447600044, 238.11905780900065, 255.11869463000062, 272.12431741700084, 289.18649336300086, 306.1948290690011, 323.19741705900105, 340.199004601001, 357.20942278200073, 374.22711512200067, 391.23772718000055, 408.2553850450008, 425.2528772680007, 442.2534114540008, 459.2700145990011, 476.2664759940012, 493.2659445380009, 510.2883896060007, 527.2968727670004, 544.2974465490006, 561.2965877540005, 578.2929952190002, 595.2954982180004, 612.3089798670007, 629.3094369130008, 646.3249020510007, 663.3380870820006, 680.3555896410007, 697.3699788960007, 714.3813446200006, 731.4422255470008, 748.4647610680008, 765.4782478370012, 782.5178397940012, 799.5581611800017, 816.5664432960016, 833.5969158450016, 850.6242877200016, 867.6325507220017, 884.6475308250015, 901.6898565210017, 918.7510736620015, 935.7936410220013, 952.8399005870015, 969.9360054260014, 986.987612322001, 1004.007915863001, 1021.0209657260011, 1038.0560718780011, 1055.0591906420009, 1072.078301905001, 1089.0885105080006, 1106.1096373450005, 1123.1252946540003, 1140.2275926480002, 1157.2568029460003, 1174.3167114140006, 1191.3607017930012, 1208.3857225630018, 1225.3953850320017, 1242.4153315380022, 1259.4701879290028, 1276.4802084570033, 1293.500277502003, 1310.5099734210025, 1327.5278883100023, 1344.538542012002, 1361.5533852410022]
times_support_3.pop()

dips_3 = [params_supports_3[i][0] for i in range(0,len(times_support_3))]
offset_min_dips_3 = [params_supports_3[i][3]+params_supports_3[i][0] for i in range(0,len(times_support_3))]
offset_3 = [params_supports_3[i][3] for i in range(0,len(times_support_3))]
linewidths_3 = [params_supports_3[i][2] for i in range(0,len(times_support_2))]
centers_3 = [params_supports_3[i][1] for i in range(0,len(times_support_2))]
diprange_normed_3 = (max(dips_3)-min(dips_3))/max(dips_3)

print("diprange support coupling to the top of the dip {}".format(diprange_normed_2))
print("diprange support coupling to the side of the dip {}".format(diprange_normed))
print("diprange free space coupling to the side of the dip {}".format(diprange_normed_fs))
print("diprange support coupling to the side of the disk {}".format(diprange_normed_3))

plt.figure(1)
plt.plot(times_support_3, offset_min_dips_3,  "y")
plt.plot(times_support_3, offset_3,  "g")
plt.legend(["V_bg - V_dip","V_background"])
plt.xlabel("Time (s)")
plt.ylabel("Voltage (V)")
plt.title("Support coupling to the side of the disk")

plt.figure(2)
plt.plot(times_support_3, linewidths_3)
plt.legend(["Linewidths"])
plt.xlabel("Time (s)")
plt.ylabel("Frequency (MHz)")
plt.title("Support coupling to the side of the disk")

plt.figure(3)
plt.plot(times_support_3, centers_3)
plt.legend(["Center point drift when not resetting wavelength"])
plt.xlabel("Time (s)")
plt.ylabel("Frequency (MHz)")
plt.title("Support coupling to the side of the disk")

plt.show()

"""
plt.figure(1)
plt.plot(times_support_2, offset_min_dips_2,  "y")
plt.plot(times_support_2, offset_2,  "g")
plt.legend(["V_bg - V_dip","V_background"])
plt.xlabel("Time (s)")
plt.ylabel("Voltage (V)")
plt.title("Support coupling to the top of the disk")

plt.figure(2)
plt.plot(times_support_2, linewidths_2)
plt.legend(["Linewidths"])
plt.xlabel("Time (s)")
plt.ylabel("Frequency (MHz)")
plt.title("Support coupling to the top of the disk")

plt.figure(3)
plt.plot(times_support_2, centers_2)
plt.legend(["Center point drift when not resetting wavelength"])
plt.xlabel("Time (s)")
plt.ylabel("Frequency (MHz)")
plt.title("Support coupling to the top of the disk")



plt.figure(4)
plt.plot(time_cum, offset_min_dips_fs,  "y")
plt.plot(time_cum, offset_fs,  "g")
plt.legend(["V_bg - V_dip","V_background"])
plt.xlabel("Time (s)")
plt.ylabel("Voltage (V)")
plt.title("Free space coupling to side of disk")
plt.figure(5)
plt.plot(time_cum, linewidths_fs)
plt.legend(["Linewidths"])
plt.xlabel("Time (s)")
plt.ylabel("Frequency (MHz)")
plt.title("Free space coupling to side of disk")
plt.figure(6)
plt.plot(time_cum, centers_fs)
plt.legend(["Center point drift when resetting wavelength"])
plt.xlabel("Time (s)")
plt.ylabel("Frequency (MHz)")
plt.title("Free space coupling to side of disk")



plt.figure(7)
plt.plot(time_cum, offset_min_dips,  "y")
plt.plot(time_cum, offset,  "g")
plt.legend(["V_bg - V_dip","V_background"])
plt.xlabel("Time (s)")
plt.ylabel("Voltage (V)")
plt.title("Support coupling to side of disk")
plt.figure(8)
plt.plot(time_cum, linewidths)
plt.legend(["Linewidths"])
plt.xlabel("Time (s)")
plt.ylabel("Frequency (MHz)")
plt.title("Support coupling to side of disk")
plt.figure(9)
plt.plot(time_cum, centers)
plt.legend(["Center point drift when resetting wavelength"])
plt.xlabel("Time (s)")
plt.ylabel("Frequency (MHz)")
plt.title("Support coupling to side of disk")


plt.show()
"""
"""
plt.figure(1)
plt.plot(x_data, lor_peak_1 + background_noise, "g")
#plt.fill_between(x_array, lor_peak_1.min(), lor_peak_1, facecolor="green", alpha=0.5)

plt.plot(x_data, background_noise, "y")
#plt.fill_between(x_data, background_noise.min(), background_noise, facecolor="yellow", alpha=0.5)  

plt.plot(x_data, final_fit, "r")
#plt.plot(x_data, lor_peak_1, "g")
plt.plot(x_data, y_data, "b")
plt.show()
"""



